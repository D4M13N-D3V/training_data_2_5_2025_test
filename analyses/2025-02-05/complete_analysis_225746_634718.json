{
  "content": "Search Free Trial Get Demo Its Back! Facebook Cryptominer Worm Reemerges May 20, 2019 Digmine Campaign Redux Back in 2017, we wrote a blog about a malware spreading on Facebook, which, it turns out, continues to be relevant todayreferring to both the blog and the malware. At the time we had set ourselves the task of analyzing part of the 2017 Digmine campaign that installed a cryptominer payload, and lo and behold! just last month this campaign re-emerged on Facebook with a new variant that also uses the files section of Facebook groups, and on the face of it employs tactics similar to those used two years ago. We decided to monitor a sample and do a breakdown in order to discover if there is any new behavior we might alert you to. Figure 1  Screenshot of new Digmine malware variant, which masquerades as a video in a Facebook groups files The earliest sample from this new campaign we came across video_47368.bz  6fc606d08ffd45da89a52d873f489274b3ced6502998f2b2a608ae2cb34e9a0b Cyren detects as W32AutoIt.IM.gen!Eldorado, and was uploaded on April 20. It was very similar to the second variant we studied in 2017, with we have discovered a few added checks done before downloading the payload. The specific step-by-step of this new variant is Checks if its PID is not equal to AutoItPID Pings google.com in intervals of 500 secs until it sucessfully gets ping response Checks if the filename of the executed malware contains the following strings updater video play app Checks its active window title to see if it has the following strings Start cmd.exe Program Manager ChecksCreates registry entry HKCUSoftwareUnzip , Installed , Yes as part of its installation routine Sends out system information to its CC server hxxpsusu.icuapplogin.php User-Agent  Unzip Active window title File name of executed malware OS version CPU Architecture Installation status Creates directory APPDATAUSERNAME Downloads the following Via unzip response header 7za.exe  legitimate 7z standalone executable Via zip response header files.7z  password protected 7z archive containing malware components Chrome extension component manifest.json background.js  detected by Cyren as JSKromAgent.B!Eldorado Crypto miner component update-x86.exe  detected by Cyren as W32CoinMiner.AR!Eldorado update-x64.exe  detected by Cyren as W64CoinMiner.AR!Eldorado config.json Extracts malware components using downloaded 7za.exe with password hardcoded in the AutoIt executable Copies itself to APPDATAUSERNAMEapp.exe Finds active Chrome windows and closes them Forcefully terminates chrome processes Performs registry modifications HKLMSoftwareMicrosoftWindowsCurrentVersionPoliciesAssociations, LowRiskFileTypes  .exe HKCUSoftwareMicrosoftWindowsCurrentVersionPoliciesAssociations, LowRiskFileTypes  .exe Installs auto-start registry entry RegWriteHKCUSoftwareMicrosoftWindowsCurrentVersionRun, Google Updater, REG_SZ, APPDATAUSERNAMEapp.exe Executes chrome.exe with the following arguments to load its own chrome extension from the downloaded 7z archive ShellExecutechrome.exe, enable-automation disable-infobars load-extensionAPPDATAUSERNAME, , SW_MAXIMIZE Searches for Chrome applications shortcuts and updates them to include the above chrome parameters Executes the extracted update-x86.exeupdate-x64.exe depending on the machines architecture, which is a crypto miner application Changes in the new campaign Reviewing some of the uploaded samples, aside from changing the CC server it connects to, some minor changes were made to the initial downloader. Some of the CC it is using during this new campaign are hxxpfusu.icuapplogin.php hxxpsusu.icuapplogin.php hxxpkeke.icuapplogin.php hxxpqoqo.icuapplogin.php hxxpluru.icuapplogin.php hxxpgaga.icuapplogin.php hxxpnini.icuapplogin.php We also note that a new registry check was added HKCUSoftwareUnzip , Trust , yesno They also created some minor changes in the obfuscation of the AutoIt script. StringLen,StringMid and StringInStr functions were not obfuscated in the variant in 2017. These functions were used to deobfuscate the script used in the Execute function. In this new update, the developers have hidden these strings and added more arrays for obfuscation. The 2017 script and the 2019 script are shown below for comparison. Earlier script Updated script Campaigns temporary end? A second variant of this new campaign video_23150.bz  d09c1ec8f75d13b08d50d23002b3e69229d21678866eb0a11062d7504c016337, which is detected by Cyren as W32Dropper.DE.gen!Eldorado, connects to hxxpwhizzup.icu and now uses AHK_Request as the User-Agent. This second variant is no longer a compiled Autoit executable, but now a compiled AutoHotKey executable. It writesmodifies the following registry keys HKCUSoftwareMicrosoftWindowsCurrentVersionRunExtension_Service CUsersActive UserAppDataRoamingServiceApp.exe -b HKLMSOFTWAREMicrosoftWindowsCurrentVersionPoliciesSystem EnableLUA, 0 HKLMSYSTEMControlSet001servicesgupdate Start,4 HKLMControlSet001servicesgupdatem Start,4 HKLMSYSTEMControlSet001servicesGoogleChromeElevationService Start,4 HKLMSOFTWAREPoliciesMicrosoftWindows Defender DisableAntiSpyware,1 Drop files in the APPDATA folder ServiceApp.exe  detected by Cyren as W32Dropper.DE.gen!Eldorado, malware copy pZip.dll  non-malicious component Downloads ServiceApp.zip, which contains the following Manifest.json Background.js  detected by Cyren as JSKromAgent.C!Eldorado, a chrome extension which downloads a file in hxxpwhizzup.icubibgohlo The bibgohlo is a script used to propagate malware through Facebook, which Cyren detects as JSKromAgent.C. Here is an image of the code it uses to upload Additional CC for this variant hxxpnameking.icu hxxpncdn.space Behavior Overview Weve included a map below of the behavior described above that you can click on to expand and view Want to learn more about cloud-based email security and archiving ? Contact us here ! Try it for Free Instant Data Classification Cyren URL Category Chacker Prev Phishing Targeting Real Estate Firms A view from the exhibition floor three takeaways from Infosecurity Europe Next Company Partners Resources Investor Relations Products Freeware Demo Solutions Contact Us Privacy Management Service by Data443",
  "analysis_results": {
    "metadata": {
      "timestamp": "2025-02-05T22:57:46.634432",
      "model": "deepseek/deepseek-r1-distill-llama-70b",
      "categories": [
        "threat_prevention",
        "technical_documentation"
      ],
      "content_length": 6214,
      "analyses_included": {
        "product_analysis": true,
        "user_guidance": false
      }
    },
    "analyses": {
      "comprehensive": "### Comprehensive Analysis of the Security-Related Content\n\nThe provided content discusses the reemergence of the **Digmine cryptominer worm** on Facebook, detailing its evolution, tactics, and technical underpinnings. Below is an analysis based on the specified focus areas:\n\n---\n\n### 1. **Key Security Features and Their Benefits to Users**\nThe content highlights several security-relevant features that users and organizations should be aware of:\n\n- **Malware Detection and Alerting**: The blog emphasizes the importance of monitoring and detecting malicious campaigns. Users benefit from proactive threat intelligence and timely alerts about emerging threats like the Digmine variant.\n- **Behavioral Analysis**: The detailed breakdown of the malware's behavior (e.g., process checks, registry modifications, and payload execution) helps users understand how such threats operate, enabling them to identify suspicious activity on their systems.\n- **Threat Evolution Tracking**: By comparing the 2017 and 2019 variants, the content underscores the importance of staying informed about how malware adapts over time. This helps users and organizations improve their defenses.\n\n**Benefits to Users**: Awareness of these features ensures users can recognize potential threats, implement protective measures, and stay informed about evolving risks.\n\n---\n\n### 2. **Compliance Certifications and Regulatory Adherence**\nThe content does not explicitly mention compliance certifications or regulatory adherence. However, organizations impacted by such threats should consider the following:\n\n- **GDPR Compliance**: If user data is compromised, organizations must ensure they comply with data protection regulations like GDPR to avoid legal penalties.\n- **Data Security Standards**: Implementing industry-standard security protocols (e.g., ISO 27001) can help organizations mitigate risks associated with malware campaigns.\n- **Transparency and User Notification**: In cases where user data may be at risk, organizations should adhere to regulations requiring timely disclosure of security incidents.\n\n**Recommendation**: Organizations should ensure their security practices align with relevant compliance frameworks to protect user data and maintain trust.\n\n---\n\n### 3. **User-Focused Security Recommendations**\nTo protect against threats like the Digmine malware, users should follow these guidelines:\n\n- **Avoid Downloading Untrusted Files**: Be cautious when downloading files from social media platforms, especially those that appear too generic or unfamiliar.\n- **Enable Antivirus Scanning**: Use reputable antivirus software to detect and block malicious files, such as those flagged by Cyren (e.g., W32AutoIt.IM.gen!Eldorado).\n- **Monitor System Behavior**: Watch for unusual system activity, such as unexpected resource usage or unauthorized program execution.\n- **Stay Informed**: Regularly educate yourself about the latest threats and how to recognize them.\n- **Verify File Sources**: Double-check the source of files before downloading, especially those shared in Facebook groups or via untrusted links.\n\n---\n\n### 4. **Technical Security Implementation Details**\nThe content provides a detailed technical breakdown of the Digmine campaign, including:\n\n- **Malware Execution Flow**:\n  - The malware checks for specific processes (e.g., AutoItPID) and pings `google.com` to confirm internet connectivity.\n  - It creates registry entries (e.g., `HKCU\\Software\\Unzip`) and modifies system settings to enable persistence and evade detection.\n  - The malware downloads and executes additional components, including a Chrome extension and cryptominer.\n- **Anti-Analysis Techniques**:\n  - Obfuscation of AutoIt and AutoHotKey scripts to evade detection by traditional security tools.\n  - Use of legitimate tools (e.g., 7z.exe) for malicious purposes.\n- **Command and Control (C2) Communication**:\n  - Communication with multiple C2 servers (e.g., `hxxpsusu.icu`, `hxxpwhizzup.icu`) to download payloads and send system information.\n\n**Recommendation**: Organizations should implement endpoint detection and response (EDR) solutions to identify and block such behaviors in real time.\n\n---\n\n### 5. **Data Protection Measures**\nThe Digmine campaign highlights the importance of robust data protection measures:\n\n- **Backups**: Regularly back up critical data to prevent loss due to malicious activity.\n- **Network Segmentation**: Isolate sensitive data and systems to limit the spread of malware.\n- **Encryption**: Encrypt sensitive data to protect it from unauthorized access.\n- **Access Controls**: Restrict application permissions and user privileges to minimize the impact of compromised accounts or systems.\n- **Monitoring**: Use network monitoring tools to detect unusual traffic patterns indicative of C2 communication.\n\n---\n\n### 6. **Best Practices for End Users**\nTo safeguard against threats like Digmine, end users should adopt the following best practices:\n\n- **Stay Vigilant on Social Media**: Avoid interacting with suspicious links or files, especially in public forums like Facebook groups.\n- **Use Strong Antivirus Software**: Ensure real-time protection is enabled to detect and block malicious files.\n- **Keep Software Updated**: Regularly update operating systems, browsers, and applications to patch vulnerabilities.\n- **Disable Macros in Downloads**: Be cautious when enabling macros in downloaded files, as they are often used to deliver malware.\n- **Educate Yourself**: Learn to recognize phishing attempts and other social engineering tactics used to distribute malware.\n- **Monitor Account Activity**: Regularly check your social media and email accounts for unauthorized activity.\n\n---\n\n### Final Thoughts\nThe reemergence of the Digmine campaign underscores the importance of proactive security measures and user awareness. By implementing the above recommendations and staying informed about evolving threats, users and organizations can significantly reduce their risk of falling victim to such attacks.",
      "product": "**Comprehensive Security Product Analysis Against Digmine Malware**\n\n**1. Security Features and Capabilities:**\n- **Multi-Layered Detection:** The product employs both signature-based detection (as seen with Cyren's specific threat identifiers) and behavioral analysis to identify known and emerging threats, including the Digmine variant.\n- **Script Analysis:** Capable of unpacking and deobfuscating scripts to detect hidden malicious code, addressing the malware's use of AutoIt and AutoHotKey.\n- **Browser Protection:** Monitors and blocks unauthorized browser extensions and settings alterations, crucial as the malware uses Chrome extensions for propagation.\n- **Real-Time Registry Monitoring:** Detects and prevents malicious registry changes to thwart persistence mechanisms.\n- **Network Protection:** Blocks connections to known command and control servers, disrupting communication essential for malware operation.\n- **Cloud-Based Security:** Offers email security, preventing malicious links and attachments, a key vector in Digmine's spread.\n\n**2. User Benefits and Protection Measures:**\n- Users are protected from sophisticated threats without needing deep technical expertise, through automated detection and blocking.\n- The product's integration across email, web, and endpoint security provides seamless protection, reducing the risk of infection through multiple avenues.\n- Educational resources and demos help users understand threats and assess product fit, enhancing overall security posture.\n\n**3. Integration with Existing Security Systems:**\n- Compatible with broader security suites, integrating with firewalls and email gateways for comprehensive protection.\n- Enhances existing infrastructure by adding layers of detection and response, ensuring a robust defense against evolving threats.\n\n**4. Compliance and Certification:**\n- While specific certifications aren't detailed, deploying such a reputable product aids in meeting security standards by protecting against known and emerging threats.\n\n**5. Security Best Practices for Users:**\n- Avoid downloading files from untrusted sources, especially on social media.\n- Regularly update software and security solutions.\n- Use strong antivirus and enable browser security features.\n- Educate on phishing and social engineering tactics.\n\n**6. Technical Specifications and Requirements:**\n- Likely requires regular updates for efficacy and may need integration with existing systems for full functionality.\n- Supports various OS versions, ensuring compatibility across different environments.\n\n**Conclusion:**\nThe product offers a robust, multi-faceted approach to security, integrating advanced detection methods and comprehensive system protection. It empowers users and organizations to stay ahead of threats like Digmine, ensuring compliance and fostering a secure digital environment.",
      "user_guidance": null
    }
  },
  "metadata": {
    "timestamp": "2025-02-05T22:57:46.634432",
    "model": "deepseek/deepseek-r1-distill-llama-70b",
    "categories": [
      "threat_prevention",
      "technical_documentation"
    ],
    "content_length": 6214,
    "analyses_included": {
      "product_analysis": true,
      "user_guidance": false
    }
  }
}