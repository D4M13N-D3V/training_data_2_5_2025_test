{
  "timestamp": "2025-02-05T23:33:28.098322",
  "content": "Search Free Trial Get Demo Fake Invoice Carries Rescoms Malware November 15, 2017 Emails containing malicious attachments equipped with keyloggers and screen capture capabilities are targeting businesses worldwide, with noted attacks in Asia, Russia, and the Middle East. The campaign is designed to look like it comes from real affiliates and employees working for a well-known pharmaceutical distributor in order to make the emails more convincing and lure the recipients into opening the attached document. The malware exploits two known Microsoft vulnerabilities CVE-2017-0199 and CVE-2017-8759 and includes obfuscation tools, such as sandbox detection. Cyren detects and blocks this threat as XMLCVE170199, CVE-2017-8759!Camelot,W32TinyDL.A and W32Rescoms.G. How It Works An email arrives from what appears to be a reputable person and company in the pharmaceutical industry containing an attachment that looks like an invoice or statement. Figure 1  Email Sample To initiate the installation of the main malware, this attack first exploits the Microsoft vulnerability CVE-2017-0199 to automatically update the document with malicious contentin this case, a file named free.doc accessed directly from the threat actors server. Figure 2 CVE-2017-0199 exploit automatically updates using free.doc directly from the threat actors server. Figure 3  MS Word prompts user to update document from linked files. The downloaded document contains a linked document object with hidden text that when executed exploits a second vulnerability known as CVE-2017-8759, which takes advantage of a vulnerability in MS Offices SOAP WSDL Parser. Figure 4  Hidden linked document object Figure 5 CVE-2017-8759 Exploit The CVE-2017-8759 exploit runs .Net code, which drops and installs an executable binary in the Windows temporary directory. This file which Cyren detects as W32TinyDL.A downloads the main malware component and saves it in LOCALAPPDATAavast.exe. Cyren detects the main malware component as W32Rescoms.G. AnalysisPayload W32Rescoms.G The Backdoor payload dump strings suggest that it is a variant of Remcos RAT. Checking the latest free version of the Remote Access Trojan reveals the different capabilities it can do on an infected system. Figure 6 Builder Options Figure 7 Installation Options Figure 8 Process Injection and Sandbox Detection Options Figure 9 Keylogging Options Figure 10 Screen Capture Options Figure 11 Remote Options Digging deeper on the backdoor payload, we can find the settings in the resource section of the file. Figure 11 1 st byte is the size of the RC4 key and the actual key next to it This version still uses the RC4 encryption and with the settings decrypted, it reveals that it will try to connect to the following remote host and use pass as the password. CC  infocolornido.publicvm.com port  2404 password  pass Mitigation With malware exploding around the globe, it is critical that companies put essential steps in place to protect from new and existing threats. Cloud-based Email and Web Security Email and web security gateways instantly filters and block malicious or unwanted email and malware threats for all users on your network, regardless of user location or device type. Patching It is common for threat actors to use recently disclosedpatched vulnerabilities since they know that companies are sometimes notoriously bad at updating and applying patches to their networks. The attack takes advantage of two known exploits that Microsoft has identified and provided fixes for. Updating software and applying patches is a critical step to safeguarding your networks.    Disabling Links In addition to cloud-based security and system patches, another option in this kind of threat scenario is to disable the automatic links at open function, also used successfully with the recent DDE vulnerability. Please note that we only tested it on Microsoft Word 2016. File-Options-Advanced-General- Uncheck Update automatic links at open. Indicators of Compromise SHA256URL DescriptionDetection Case 1 074ede6276def79b95c342289bc940deb05fdeaf4bc4896e7fc3c8f6578e6c57 E-mail, Subject Payment confirmation attached. 7b2c39c838c6629543f1185750b4e41612810722947b4818d15dbbaad99033e1 E-mail, Subject Payment confirmation attached 8505309fd4e78db3f6efdc49bae5b8e045d89d6dd665d245cfa0101b4d39a6bb Filename Nov Payment.docx, XMLCVE170199 hxxp23.92.211.215kfree.doc Link to CVE-2017-8759 exploit 7affc3737c52bf39a03e725184836efc647dd001ec90229d6c4ec887fb741fd6 CVE-2017-8759!Camelot hxxp23.92.211.215kxin.png Link to CVE-2017-8759 payload 60ce039c026d191d996448963aa186e96d50c445b7bb07360318393edbf7ccdb Filename xin.png, XMLDropExe.A 445a15c88ed27e01e668e17bd47c6793ba5361b98a903c40d1a1f22eeb453684 Filename TMPrandom.exe, W32TinyDL.A e5da506ab6ccb1b3d24cd1fc3030a3e7e65b29b75e92a02a6c2ff57e73ddf85e Filename avast.exe, W32Rescoms.G References  Case 2 hxxpa.pomfe.cowhmpqn.doc Download link 856cf2046fb797d83df6beb620956a9845a99f479ef134cec7db0743f462f958 Filename whmpqn.doc, CVE-2017-8759!Camelot 2a8da20bd8bac77805b4facd4fabb04a49b5f6c6af8085023ee64568463189dc Filename epraeb, CVE178759 3f065107b25dfd77e14ebef919419d00cde19d5372168161cb6d8ae7782eb32d Filename usa.exe, W32Injector.GAV References  Additional IOCs dd52fdd55f1835048fbe425a2123bf4d452773cbfaf567d6c30d2d59cd577fc hxxp23.92.211.215tutu.doc bfcc360a49eea396ca8d417c10fa84673fa5d70ccd4ccf20d195a28460b09dfd hxxp23.92.211.215kdd.doc 8505309fd4e78db3f6efdc49bae5b8e045d89d6dd665d245cfa0101b4d39a6bb hxxp23.92.211.215kfree.doc f4c98a007d77cca4172cd2ad93f42dbc0c5ec578bda44b537c9fb56480b10ed9 hxxp23.92.211.215re.doc 6837634e75a4e1966bdaef7f42f1ac765859da5777938660329ef151ab7e32d7 hxxp23.92.211.215knilo.doc 17f6e1b561f9c16d09848b49210a94cd6c82927771cb8be572155aac3570d1bb hxxpultrachem-tw.comnkl.doc Try it for Free Instant Data Classification Cyren URL Category Chacker Prev Stealing Tax Refunds Soaring Worldwide How Do You Know Your Email Security Is Working? Next Company Partners Resources Investor Relations Products Freeware Demo Solutions Contact Us Privacy Management Service by Data443",
  "analysis_type": "user_guidance",
  "analysis": "**Security Guidance: Protecting Against Fake Invoice Malware Attacks**\n\n**1. Security Best Practices:**\n   - **Regular Software Updates:** Ensure all software, especially Microsoft products, are updated with the latest patches to protect against known vulnerabilities (e.g., CVE-2017-0199 and CVE-2017-8759).\n   - **User Education:** Conduct regular training sessions on identifying phishing attempts and safe email practices.\n   - **Antivirus Use:** Install and regularly update antivirus software to detect and block threats like Remcos RAT.\n\n**2. Data Protection Recommendations:**\n   - **Encryption:** Encrypt sensitive data to prevent unauthorized access in case of a breach.\n   - **Backups:** Perform regular backups and store them securely off-network for quick recovery.\n   - **Access Control:** Restrict data access to authorized personnel to minimize potential damage.\n\n**3. Safe Usage Guidelines:**\n   - **Email Caution:** Advise users to be cautious with unsolicited emails and attachments. Verify the sender before opening.\n   - **Disable Auto Links:** Guide users to disable automatic link updates in Microsoft Office (e.g., in Word: File > Options > Advanced > Uncheck \"Update automatic links at open\").\n   - **Secure Communication:** Use encrypted channels for sharing sensitive information.\n\n**4. Common Security Risks and Prevention:**\n   - **Phishing Awareness:** Educate users to recognize phishing emails, which may appear legitimate. Suggest verifying senders through known contact methods.\n   - **Monitor Accounts:** Teach users to watch for signs of unauthorized access, such as unusual activity, and report them promptly.\n\n**5. Privacy Protection Measures:**\n   - **Secure Sharing:** Emphasize the use of encryption when sharing sensitive data.\n   - **Verification:** Advise against sharing sensitive information without confirming the recipient's identity.\n\n**6. When to Seek Additional Support:**\n   - **Incident Reporting:** If a breach is suspected, users should immediately notify IT support for containment and remediation.\n   - **Regular Assessments:** Conduct periodic security audits to identify and address vulnerabilities before exploitation.\n\n**Additional Tips:**\n   - **Avoid Macros:** Caution users against enabling macros in documents from unknown sources.\n   - **Monitor for IOCs:** Be vigilant for indicators of compromise, such as unusual network activity or unfamiliar files, and report them.\n\nBy following these guidelines, users can significantly enhance their security posture and reduce the risk of falling victim to such attacks."
}