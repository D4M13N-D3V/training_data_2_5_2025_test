{
  "timestamp": "2025-02-05T22:53:16.109865",
  "content": "Search Free Trial Get Demo Not-Really-Password-Protected Evasion Technique Resurfaces October 26, 2018 Today we came across an e-mail with an Excel Workbook attachment, which upon first inspection appears to be password-protected. The presence of the EncryptedPackage stream in an OLE2 document indicates that it is protected by a password, which obviously would require the user to enter one in order to open the document properly. Or at least thats what the bad guys would like email or AV scanners to think. Figure 1 Looking at the e-mail, which is couched as a very generic price quote request, the sender did not provide any password for the attachment, so what gives? Figure 2 Sounds like something weve already seen a few years back, six years to be exact. Do you remember VelvetSweatshop and the infamous CVE-2012-0158 exploit which took advantage of the Microsoft Excel default password hidden feature to evade detection? Well, this malware campaign will surely bring you back to those old days. First lets try to open the document to see if Microsoft Office will be able to load it properly. Figure 3 Figure 4 And sure thing, Microsoft Office Excel was able to open the document with no problems at alland no request to enter a password. So lets take a look at whats happening in the background. Exploits Office Vulnerability CVE-2017-11882 The first thing youll notice is the presence of EQNEDT32.EXE being loaded by svchost.exe. This behavior indicates a possible exploitation of CVE-2017-11882 Microsoft Office Memory Corruption Vulnerability. Figure 5 Digging a little deeper, we debugged the exploit shellcode to see what this document really does in the background. Sure enough, this sample does indeed exploit CVE-2017-11882 and attempts to download and execute an executable payload supposedly saved as PUBLICvbc.exe in the affected computers system, as shown in the screenshots below. Figure 6 Figure 7 VelvetSweatshop Default Password Ploy Still Being Used We also decrypted the email attachment and confirmed that this document is taking advantage of the old Microsoft Office hidden feature that uses a default password to load encrypted documents, as shown in the lines of code in the screenshot below. Figure 8 Unfortunately, the download link from this exploit sample was inaccessible as of this writing, so we are not able to provide an analysis of its payload. Indicators of Compromise and Cyren Detection SHA256 Object Type Remarks Cyren Detection 04ee59add6c2df247f97a17eab8594a2a28b7e17e7ce3e9cc5c334ae0ac265de EML Subject Prices required  CVE1711882 fe5568568d4930866d29699b46e11711c462bfcefd05589e98c6b5250da074ff EML Subject Prices required  CVE1711882 73675e415abe136fa06070d5781d5d0d84c415111b0c65d43910e44146124642 XLS Password-protected VelvetSweatsho CVE1711882  URL Saved to PUBLICvbc.exe Payload Inaccessible as of this writing Prevention and Mitigation We remind readers that Microsoft issued a patch for the CVE-2017-11882 exploit in 2017. Outdated software, operating systems, browsers, and plugins are major vectors for malware infections. Try it for Free Instant Data Classification Cyren URL Category Chacker Prev Police Phishing Attack Targets Bank Credentials Fileless Malware Already Targeting Holiday Suppliers Next Company Partners Resources Investor Relations Products Freeware Demo Solutions Contact Us Privacy Management Service by Data443",
  "analysis_type": "comprehensive",
  "analysis": "**Comprehensive Analysis of Security Content**\n\n1. **Key Security Features and Their Benefits to Users:**\n   - **Default Password Feature:** The Excel file uses a hidden default password, which, while intended to facilitate ease of use, poses a security risk by allowing unauthorized access. This highlights the importance of user awareness in recognizing such manipulations.\n   - **Microsoft Patches:** Microsoft's issuance of patches for vulnerabilities like CVE-2017-11882 is a crucial feature that addresses security loopholes, ensuring a safer environment for users.\n\n2. **Compliance Certifications and Regulatory Adherence:**\n   - **Vulnerability Management:** Compliance with standards often requires regular software updates. The patch for CVE-2017-11882 aligns with such regulatory requirements, emphasizing the importance of timely updates for security.\n\n3. **User-Focused Security Recommendations:**\n   - **Caution with Emails:** Users should be vigilant with unsolicited emails, especially those with attachments, and avoid interacting with them without verification.\n   - **Software Updates:** Keeping software updated is essential to protect against known vulnerabilities.\n\n4. **Technical Security Implementation Details:**\n   - **Vulnerability Exploitation:** The exploit uses CVE-2017-11882, targeting Microsoft Office's memory corruption. Awareness of such vectors aids in understanding attack mechanisms.\n   - **Process and Network Monitoring:** Monitoring processes like EQNEDT32.EXE and network activities for suspicious URLs can help detect and prevent attacks.\n\n5. **Data Protection Measures:**\n   - **Encryption and Backups:** While not explicitly mentioned, protecting data through encryption and regular backups is implied to safeguard against potential data loss from malware.\n\n6. **Best Practices for End Users:**\n   - **Email Hygiene:** Users should avoid opening suspicious attachments and report such emails.\n   - **Regular Updates:** Ensuring all software is updated is crucial to prevent exploitation of known vulnerabilities.\n\nThis analysis underscores the importance of a multi-faceted approach to security, combining technical measures with user education to mitigate risks effectively."
}