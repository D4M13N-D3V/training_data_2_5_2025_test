{
  "timestamp": "2025-02-05T23:05:55.593521",
  "content": "Search Free Trial Get Demo Email Hijacking Delivers Qakbot Malware August 4, 2022 Introduction Originally a banking Trojan that existed in the wild as early as 2007, Qakbot or QBot is a pioneer of malware as a service, which is continually maintained and developed to this day. While its main purpose is to steal banking credentials such as logins and passwords, it has also added functionalities to spy on financial operations, spread itself and install ransomware in compromised organizations to maximize revenue for cybercriminals. Email Hijacking Recently we have observed the following malware campaign exhibiting a man-in-the-middle MITM attack known as email hijacking, where malicious replies are inserted between existing legitimate email conversations. This kind of attack is commonly executed through compromised email accounts of users, who are most probably also infected with Qakbot. Figure 1. Qakbot malware infection chain Figure 2. Hijacked email thread Figure 3. Hijacked email reply The hijacked email message includes a link to a file, which looks related to alleged attachments discussed in the email conversation. To further lure the reader into clicking on the malicious download link, the threat actor purposefully saves the malicious payload in a password-protected ZIP file and mentions the password in the email message. The malicious link redirects the user to download a password-protected ZIP file that contains a malicious Windows Shortcut file LNK. Figure 4. Malicious LNK commands Once the downloaded ZIP file is extracted using the password provided in the email, and the contained Windows Shortcut file is executed, a JavaScript payload is downloaded and executed via wscript. the Qakbot DLL payload and execute it via regsvr32, the new variant makes use of JavaScript as an additional layer of execution, preventing security solutions from immediately detecting the final payload. The downloaded JavaScript payload is heavily obfuscated, making code analysis difficult. It includes obfuscation that hinders debuggers such as Visual Studio Code and browser source debuggers Chrome, Edge, and Firefox, causing them to raise exceptions that prevent the malware from running properly when debugged. Figure 5. Heavily obfuscated Qakbot javascript code Fortunately, we have an internal tool known as CyrenSE Cyren Script Emulator, which can emulate the obfuscated JavaScript malware and log script execution events, giving us a clearer view of the malicious behavior, as shown in the examples below. Figure 6. CyrenSE event log In this case, the JavaScript payload appears to have been included as an additional layer in the infection chain before downloading and executing the Qakbot payload which is usually delivered as executable Windows DLLs loaded via regsvr32. Unfortunately, the download links to the final malware payload are no longer accessible. The demonstrated infection chain shows a clear relation to previous Qakbot campaigns and may eventually lead to further delivery of ransomware to the intended targets. Recommendations As threat actors have become more sophisticated in the attack methods they use, implementing comprehensive email and network security has become essential for protecting your company from reputational damage, brand damage, data loss, and more. Cyren Inbox Security uses elaborate logic and remediation rules to protect its users effectively and without excess noise. Cyrens anti-phishing software solutions are designed with todays cybercrime concerns in mind. They utilize advanced anti-phishing technology to pick up and contain the most complex phishing tactics, protecting over a billion users against emerging threats. Indicators of Compromise Try it for Free Instant Data Classification Cyren URL Category Chacker Prev Example Analysis of Multi-Component Malware Protect Office 365 Email from Ransomware Next Company Partners Resources Investor Relations Products Freeware Demo Solutions Contact Us Privacy Management Service by Data443",
  "analysis_type": "user_guidance",
  "analysis": "### Security Guidance: Protecting Against Email Hijacking and Qakbot Malware\n\nThe Qakbot malware and email hijacking attacks are sophisticated threats that can lead to significant data loss, financial damage, and reputational harm. Here are practical, easy-to-follow recommendations to help you protect yourself and your organization:\n\n---\n\n### 1. **Security Best Practices**\n   - **Use Strong Passwords**: Ensure all email accounts and systems use unique, complex passwords. Avoid reusing passwords across multiple platforms.\n   - **Enable Multi-Factor Authentication (MFA)**: MFA adds an extra layer of security, making it harder for attackers to access your accounts even if they obtain your password.\n   - **Keep Software Updated**: Regularly update your operating system, email client, and security software to patch vulnerabilities.\n   - **Use Anti-Malware Tools**: Install and maintain reputable antivirus and anti-malware software to detect and block malicious files.\n   - **Educate Users**: Train employees to recognize suspicious emails, especially those requesting sensitive information or containing unexpected links or attachments.\n\n---\n\n### 2. **Data Protection Recommendations**\n   - **Backup Regularly**: Implement a robust backup strategy to protect critical data. Store backups securely, both on-premises and in the cloud.\n   - **Encrypt Sensitive Data**: Encrypt sensitive information when sending it via email or storing it on devices.\n   - **Monitor Accounts**: Regularly review email and system logs for unusual activity, such as unauthorized login attempts or changes to account settings.\n   - **Implement Email Controls**: Use email filtering tools and mechanisms like SPF, DKIM, and DMARC to reduce the risk of phishing and email hijacking.\n\n---\n\n### 3. **Safe Usage Guidelines**\n   - **Avoid Clicking on Suspicious Links or Opening Attachments**:\n     - Be cautious of emails that appear to continue a legitimate conversation but include unexpected links or attachments.\n     - Never click on links or download files from unfamiliar senders.\n   - **Verify Email Conversations**: If an email seems out of place or asks for sensitive information, contact the sender directly through a known, trusted channel.\n   - **Beware of Password-Protected ZIP Files**: Email hijacking attackers often use password-protected ZIP files to evade detection. Verify the legitimacy of such files before opening them.\n   - **Use Safe Email Practices**: Avoid using public or shared devices for accessing sensitive accounts, as these are more vulnerable to compromise.\n\n---\n\n### 4. **Common Security Risks and Prevention**\n   - **Email Hijacking**: Attackers compromise email accounts to insert malicious replies into legitimate conversations. Prevention includes:\n     - Monitoring for unauthorized account access.\n     - Using MFA to prevent unauthorized logins.\n   - **Phishing Attacks**: Be vigilant of emails that create a sense of urgency or ask for sensitive information. Verify the sender\u2019s identity before responding or clicking on links.\n   - **Malware in Email Attachments**: Avoid opening suspicious attachments, especially those from unknown senders. Use antivirus tools to scan files before opening them.\n\n---\n\n### 5. **Privacy Protection Measures**\n   - **Limit Sensitive Information in Emails**: Avoid sharing sensitive data, such as financial information or login credentials, via email unless absolutely necessary.\n   - **Secure Communication Channels**: Use encrypted communication tools for sharing sensitive information.\n   - **Monitor Privacy Settings**: Regularly review privacy settings for email accounts and other services to ensure they are configured securely.\n\n---\n\n### 6. **When to Seek Additional Security Support**\n   - If you suspect your email account or system has been compromised, act immediately:\n     - Contact your IT or security team for assistance.\n     - Disconnect from the internet to prevent further damage.\n     - Report the incident to relevant authorities if sensitive data is stolen or exposed.\n   - If you receive a suspicious email or attachment, do not engage with it. Report it to your security team for analysis.\n\n---\n\nBy following these guidelines, you can significantly reduce the risk of falling victim to email hijacking and Qakbot malware attacks. Stay proactive, educate yourself and your team, and remain vigilant in protecting your digital assets."
}