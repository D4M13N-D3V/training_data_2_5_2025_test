{
  "timestamp": "2025-02-05T22:53:19.414400",
  "content": "Search Free Trial Get Demo Covid AgentTesla April 17, 2020 With the world under threat of the COVID-19 aka corona virus, many cybercriminals are taking this opportunity to blend in the chaos. Here we have an email posing to have an order of masks. An important personal protection equipment that is on a very high demand as of this moment. Infection Chain Overview RTF Attachment Once the file is opened, it will try to exploit a vulnerability in Microsoft Word to download and execute a file. hxxpbit.ly2J9KXAM which resolves to hxxpposqit.netGE5091203.jpg 5091203.jpg The downloaded .jpg file is actually a PE Executable file. It is a .NET file so we can use DnSpy to analyze its code. Once executed, it will decrypt a DLL fileDKaQso.dll using AES from its resource and will load and execute it using Assembly.Load and InvokeMember methods. Resource section object named AL is the encrypted DKaQso.dll. Key and IV used to decrypt the file Execute X on DKaQso.dll DKaQso.dll The DLL file contains another 3 files in its resource. The 2 image files contain 1 DLL file each. 1.bmp - LOL.dll which is embedded in an image. SourceTIASK .bmp- 26.dll. which is compressed and embedded in image. IsConsoleEnabledsANCK - AgentTesla binary payload which is compressed and encrypted. It uses the Bitmap Class to get the embedded DLL in the BMP file which is a form of Steganography.Here we have an image of a snippet code which gets the first pixel and get the color.B property.The byte is equal to 0x4D which is equal to M, the start of the MZ header in PE files.It will perform a loop on each pixel and get the byte in the color.B property to form the the DLL file. In the case of 26.dll, once the file is taken out of the image, it will be decompressed. LOL.dll Once loaded and executed, the files task is to create a persistence mechanism for the malware. It checks for files and folders related to Anti-Malware vendors and creates the necessary files for its persistence mechanism. If the following files exist in the system, it will create .js file in the startup folder CProgram FilesAVAST SoftwareAvastavastUI.exe CProgram Files x86AVAST SoftwareAvastavastUI.exe CProgram FilesAVGAntivirusAVGUI.exe CProgram Files x86AVGAntivirusAVGUI.exe Content of the .js file var nPiCCaK  new ActiveXObjectShell.Application nPiCCaK.ShellExecuteMALWARE PATH, , , Open, 1 If the following folder exist in the system, it will create a shortcut link in the startup folder. CProgram Files x86KasperSky Lab FilesKasperSky Lab - folder path contains the string If windows Windows Defender exist in the system, it will create a registry entry that is linked to the malware executable path SOFTWAREMicrosoftWindowsCurrentVersionRun 26.dll This DLL is responsible for injecting the payload on Regasm.exe. It checks for the following directory related to Anti-Malware vendors CProgram FilesAVAST Software CProgram Files x86AVAST Software It also checks for the following strings related to Anti-Malware vendors BullGuard a2guard drweb vssery AVGUI bdagent odscanui bdredline It also checks for Windows Defender Payload The main payload of this infection chain is a variant of AgentTesla. The strings used by this malware is encrypted using AES. Using the info of its decryption routine,we can try and decrypt the strings it uses. Here we have the SMTP account and server it uses. SHA256 Description Detection 0cddd9b85decde446a800c9d3dee489758f39e5131c9dc4f0c06622f9370e82d email 27d601ef1a2b340b6b644493a627064f60ad8a95271248e00f7bb54a59abb069 RTF attachment  COVID 19 NEW ORDER FACE MASKS.doc CVE-2017-11882.C.gen!Camelot 69f559b9cd5b586e4a2c0bba58be74b85124a230bef6035739a325cf57066e2f downloaded payload W32MSIL_Kryptik.AIA.gen!Eldorado Try it for Free Instant Data Classification Cyren URL Category Chacker Prev File-less almost and Confused Covid-19 Exposes a Newly Remote Workforce to More Evasive Phishing Attacks Next Company Partners Resources Investor Relations Products Freeware Demo Solutions Contact Us Privacy Management Service by Data443",
  "analysis_type": "comprehensive",
  "analysis": "**Analysis of COVID-19 Themed Phishing Attack Using AgentTesla**\n\n---\n\n**1. Key Security Features and Their Implications**\n\n- **Exploitation of Vulnerabilities**: The attack uses an RTF file to exploit a known Microsoft Word vulnerability (CVE-2017-11882). This allows the download and execution of malicious files, highlighting the importance of patching software vulnerabilities.\n  \n- **Steganography**: Malware hides DLLs within images, making detection harder. This technique evades traditional antivirus software by concealing malicious code in innocuous files.\n\n- **Anti-Analysis Techniques**: The malware employs encryption to hide its activities and checks for antivirus software to avoid detection, making it stealthy and persistent.\n\n---\n\n**2. Compliance and Regulatory Considerations**\n\n- **Data Privacy Laws (GDPR, CCPA)**: The theft of sensitive information necessitates compliance with data privacy standards to protect personal data and avoid legal repercussions.\n\n- **Sector-Specific Regulations (PCI DSS, HIPAA)**: Organizations handling payment or healthcare data must ensure security measures align with these standards to maintain compliance.\n\n---\n\n**3. User-Focused Security Recommendations**\n\n- **Training and Awareness**: Educate users to recognize phishing attempts, such as verifying senders and hovering over links before clicking.\n\n- **Email Caution**: Advise users to avoid opening suspicious attachments or clicking links from unknown sources.\n\n- **Software Updates**: Ensure regular patching of software to protect against known vulnerabilities.\n\n- **Antivirus Use**: Utilize reputable antivirus software to detect and block malicious files.\n\n- **Network Monitoring**: Implement monitoring tools to detect and respond to suspicious activities promptly.\n\n---\n\n**4. Technical Implementation Details: The Attack Workflow**\n\n- **Initial Exploitation**: An RTF file exploits a Word vulnerability to download a malicious JPG file, which is a PE executable.\n\n- **DLL Execution**: The JPG decrypts a DLL using AES and loads it via .NET, showing sophisticated use of encryption and legitimate processes.\n\n- **Steganographic Extraction**: DLLs hidden in images are extracted using pixel data, demonstrating advanced evasion techniques.\n\n- **Payload Injection**: The final payload, AgentTesla, injects into Regasm.exe, indicating the use of legitimate processes for malicious ends.\n\n---\n\n**5. Data Protection Measures**\n\n- **Encryption**: Protect data at rest and in transit to prevent unauthorized access.\n\n- **Access Controls**: Implement strict policies to limit data access, reducing the risk of breaches.\n\n- **Email Filtering**: Use secure gateways to filter phishing emails before they reach users.\n\n- **Regular Backups**: Maintain tested backups to ensure recovery capabilities in case of an attack.\n\n---\n\n**6. Best Practices for End Users**\n\n- **Phishing Education**: Continuously educate users on recognizing phishing attempts to enhance security.\n\n- **Strong Passwords and MFA**: Encourage the use of strong, unique passwords and Multi-Factor Authentication (MFA) to secure accounts.\n\n- **Software Updates**: Regularly update software to protect against vulnerabilities.\n\n- **Antivirus Use**: Install and update antivirus software to detect and block threats.\n\n---\n\n**Conclusion**\n\nThe analyzed attack demonstrates a sophisticated use of multiple evasion techniques and exploit methods. Addressing these threats requires a combination of technical measures, user education, and compliance with regulatory standards. By understanding the attack's components and implementing layered defenses, organizations can significantly enhance their security posture."
}