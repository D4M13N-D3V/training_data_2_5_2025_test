{
  "timestamp": "2025-02-05T22:16:53.279339",
  "content": "Search Free Trial Get Demo A Dridex Phishing Campaign April 22, 2021 The Purchase themed email is a commonly used subject in phishing campaigns. Threat actors can easily scrape the internet, in other words, specific data is very easily gathered and copied from the web . This makes company emails a very easy target, as they are available in their websites, especially the emails for their purchasing department, as can be seen in the email sample below. Figure 1.0 Email Sample This phishing email attachment is an excel file Sales Receipt. Opening the file will prompt you to enable macros, but if we try to view the macro code, the option for Edit is grayed out. Default is disabled. Figure 2.0 You are unable to view the macro code using MS Visual Basic Editor as the project is locked. Figure 3.0 How can the macro code be checked? In order for us to check the macro code and its properties, we can use Olevba tool. Below is the dump of the macro code and the file properties. The Excel 4.0 macro sheet and Sheet2 were set to hidden, and that is the reason why we couldnt view the macro code and the worksheet named Sheet2. In order for us to view the code in the Visual Basic editor, we can use the Evil Clippy tool to unhide the macro code. Figure 3.1 Dumped macro code Figure 3.2 File properties Once we use the tool to unhide the macro, we can now use the Visual Basic editor. Since we know that it also has a hidden worksheet, we can insert the code Sheets2.Visible  True to reveal it. We can also write a file to dump the data that it will use. Figure 4.0 Opened document with Sheet2 revealed using the inserted code When analyzing the macro code, it tries to retrieve data from 2 cells. One from the main sheet, and one from the hidden sheet. It will try to use this set of data to decrypt strings that it will use later. The function Prv_orders is the one that will decrypt the strings. It will take 1 byte of data from each cell, and it will add the ascii value of the byte in Sheet1, and the numerical value of the byte in Sheet2. Then it will convert it into a character that corresponds to the value added. Looping until all data is decrypted. Figure 5.1 Encrypted data in Sheet1 Figure 5.2 The first part of the decrypted string is a set of URLs that it will use to download the payload. The 2 nd part which is delimited with the string HHHH is a code that uses Excel 4.0 Macro functions. Figure 6.0 Download URL which is delimited with D, and the highlighted part is the code using macro functions which is delimited with  The Excel 4.0 Macro code works in combination with the Main macro code. The main code will execute the Excel 4.0 Macro code using the Run function. Using a loop, the main macro code will insert the Excel 4.0 Macro code to a cell one at a time, and then execute it using the Run function. Figure 7.1 Loop code that inserts the Excel 4.0 Macro code and Using URLDownloadToFileA to download the payload Figure 7.2 Excel 4.0 Macro code that is inserted by the main macro code with comments of analysis Download URLs diamondrelationscrm.usbr3tiqhwq.tar com.arr6gf15r43.tar comkrdb0p5g.tar morgan-tel.comv0omtqtvn.tar afnan-amc.comzvlsg3le.rar deploys.liveg05rasj9h.rar comw36sfdr.zip orgqk1pybi5w.rar manivelasst.comyrd9yaw.rar ptkm2wq9ud.tar defa8vyq.zip com.brhxvwkbrb7.rar oecteam.comfwy0gd904.tar co.ukpful3zwhw.tar comsou8w8132.tar rayadigital.onlineid1l94.tar citywine.inhc7gya6.tar comt37dwfat.zip com.npn9edgondh.rar comih5kv64x.tar comqenwrvo6.tar pty8mbffurz.tar fix-america-now.orgig2764.tar andrewmaughan.comjzsxvz.rar arwenyapi.comy11mdnrf.rar comn7duez.zip comsjhflny.tar spenglerei-froehlich.dehhy8ken.tar mlr66ei475q.tar comp1sjeu.rar comhhksrdqi.rar kakovatos-studios.greuq0ewq.zip daedaltechng.comuauuit.rar arghusk.comg1o9m4u.rar comko4cgegk.tar comzyyabmm8e.zip comqvesawb.zip inc2nvvqv.tar digitalswagger.inl5dy2k.rar dechetterie-rennes-nantes.frfuvx0o2.rar comgfq5sh.rar lkhakw8c.rar com.brax4d7xz.rar comhkppgymuc.rar netdewnq5w.zip commb1fjogx.rar mobilelocalsales.comtjrq7j.zip getln.comaos20594.rar combxo2wpnq7.tar softwarenecessities.comoaq01cx9v.rar Try it for Free Instant Data Classification Cyren URL Category Chacker Prev Office 365 Phishing Email Campaign Hides Excel Template in HTML Fake DocuSign Download Page Leads to Hentai Onichan Ransomware Next Company Partners Resources Investor Relations Products Freeware Demo Solutions Contact Us Privacy Management Service by Data443",
  "analysis_type": "product",
  "analysis": "**Analysis of Security Features Related to Dridex Phishing Campaign**\n\n1. **Key Security Features:**\n   - **Detection of Hidden Macros and Sheets:** The analysis highlighted the use of hidden macros and Excel sheets, which are indicative of malicious intent. Tools like Olevba and Evil Clippy were employed to uncover these hidden elements, demonstrating the capability to detect concealed threats.\n   - **Encryption and Code Analysis:** The encrypted data within the Excel file was decrypted, showcasing the ability to analyze obfuscated code and understand the attack mechanism.\n   - **Payload Download URLs Identification:** The extraction of URLs used for downloading malicious payloads is a critical feature, as it helps in understanding the attack vector and potential command and control servers.\n\n2. **User Benefits and Protection Measures:**\n   - **Automated Threat Analysis:** Tools like Olevba facilitate automated analysis of suspicious files, enabling quick detection of threats without manual intervention.\n   - **Sandbox Environment:** The use of a sandbox environment for executing and analyzing the macro code ensures that potential threats are contained and do not affect the actual network.\n   - **URL Filtering:** Identifying and blocking malicious URLs helps prevent the download of payloads, thereby protecting users from further stages of the attack.\n\n3. **Integration with Existing Security Systems:**\n   - **Threat Intelligence Sharing:** Security tools can share threat intelligence with other systems, enhancing overall defense mechanisms.\n   - **API Integration:** Many security tools offer APIs that allow integration with existing antivirus, email gateways, and SIEM systems, ensuring a unified defense strategy.\n   - **Incident Response Plans:** Integration with existing systems enables effective incident response, allowing for rapid containment and remediation.\n\n4. **Compliance and Certification:**\n   - **GDPR Compliance:** Ensuring data protection and privacy adherence, crucial for organizations handling sensitive information.\n   - **ISO 27001 Certification:** Demonstrates alignment with international security standards, ensuring robust information security management.\n\n5. **Security Best Practices for Users:**\n   - **User Awareness Training:** Regular training to recognize phishing attempts and avoid suspicious emails.\n   - **Software Updates:** Ensuring all software is up-to-date to protect against vulnerabilities.\n   - **Antivirus Use:** Deploying reputable antivirus software to detect and block malicious files.\n   - **Network Monitoring:** Continuous monitoring of traffic for suspicious activities and implementing URL filtering.\n   - **Incident Response Planning:** Having clear plans to respond to and contain security incidents effectively.\n\n6. **Technical Specifications and Requirements:**\n   - **Tools and Software:** Use of Olevba and Evil Clippy, which may require specific system configurations for optimal performance.\n   - **Sandbox Environment:** A controlled environment with necessary tools and monitoring capabilities to analyze threats safely.\n   - **Threat Intelligence:** Regularly updated databases to recognize new threats and tactics.\n   - **System Requirements:** Ensure compatibility with software versions and browsers for effective threat analysis.\n\nThis structured approach ensures a comprehensive understanding of the security features and their application in mitigating the Dridex phishing campaign threat."
}